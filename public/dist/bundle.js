import rs from"react";import ns from"react-dom/client";import{useState as eo,useEffect as ss}from"react";import{useState as ae,useEffect as fo}from"react";var so=()=>localStorage.getItem("admin_token"),v=async(e,o={})=>{let t=so(),s={"Content-Type":"application/json",...o.headers};t&&(s.Authorization=`Bearer ${t}`);try{let r=await fetch(`/api${e}`,{...o,headers:s});if(!r.ok){let a=`Server error: ${r.status} ${r.statusText}`;try{let c=await r.json();a=c.error||c.message||a}catch{}throw new Error(a)}return r.status===204||r.headers.get("content-length")==="0"?null:r.json()}catch(r){throw r instanceof Error?new Error(r.message||"A network error occurred."):new Error("An unknown error occurred.")}},Le=()=>v("/session"),Ve=()=>v("/logout",{method:"POST"}),Re=()=>v("/settings/public"),Ae=e=>v("/connect/voucher",{method:"POST",body:JSON.stringify({code:e})}),Ge=()=>v("/connect/coin",{method:"POST"}),Me=async e=>(await v("/admin/login",{method:"POST",body:JSON.stringify({password:e})})).token,Ee=()=>v("/admin/stats"),Te=()=>v("/admin/system-info"),Fe=()=>v("/admin/vouchers"),He=e=>v("/admin/vouchers",{method:"POST",body:JSON.stringify({duration:e})}),De=()=>v("/admin/settings/portal"),We=e=>v("/admin/settings/portal",{method:"POST",body:JSON.stringify(e)}),Be=()=>v("/admin/settings/gpio"),Ue=e=>v("/admin/settings/gpio",{method:"POST",body:JSON.stringify(e)}),ze=()=>v("/admin/updater/status"),Oe=()=>v("/admin/updater/start",{method:"POST"}),$e=()=>v("/admin/backups"),je=()=>v("/admin/backups",{method:"POST"}),Je=e=>v("/admin/backups/restore",{method:"POST",body:JSON.stringify({filename:e})}),_e=e=>v("/admin/backups",{method:"DELETE",body:JSON.stringify({filename:e})}),Xe=()=>v("/admin/network/config"),qe=e=>v("/admin/network/config",{method:"POST",body:JSON.stringify(e)}),Ke=()=>v("/admin/network/info"),Ye=()=>v("/admin/network/wan"),Ze=()=>v("/admin/portal/html"),Qe=e=>v("/admin/portal/html",{method:"POST",body:JSON.stringify({html:e})}),et=()=>v("/admin/portal/reset",{method:"POST"});import{useState as ao,useEffect as tt}from"react";import{jsx as io}from"react/jsx-runtime";var ro=e=>{e<0&&(e=0);let o=Math.floor(e/3600),t=Math.floor(e%3600/60),s=e%60;return[o,t,s].map(r=>r.toString().padStart(2,"0")).join(":")},no=({initialRemainingTime:e,onExpire:o})=>{let[t,s]=ao(e);return tt(()=>{s(e)},[e]),tt(()=>{if(t<=0){o();return}let r=setInterval(()=>{s(a=>a-1)},1e3);return()=>clearInterval(r)},[t,o]),io("div",{className:"text-4xl font-bold text-center text-gray-800 tracking-wider",children:ro(t)})},ot=no;import{useState as we}from"react";import{jsx as _,jsxs as co}from"react/jsx-runtime";var lo=e=>co("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6.75h0"}),_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75zM16.5 9h0"}),_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 9h.75v.75h-.75zM16.5 11.25h0"}),_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 11.25h.75v.75h-.75zM16.5 13.5h0"}),_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 13.5h.75v.75h-.75zM16.5 15.75h0"}),_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 15.75h.75v.75h-.75z"}),_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75h6v9H9z"}),_("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 6.75A2.25 2.25 0 016.75 4.5h10.5A2.25 2.25 0 0119.5 6.75v10.5A2.25 2.25 0 0117.25 19.5H6.75A2.25 2.25 0 014.5 17.25V6.75z"})]}),X=lo;import{jsx as F,jsxs as te}from"react/jsx-runtime";var mo=({onConnect:e})=>{let[o,t]=we(""),[s,r]=we(!1),[a,c]=we("");return te("div",{className:"animate-fade-in",children:[F("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-6",children:"Connect to Internet"}),te("form",{onSubmit:async d=>{if(d.preventDefault(),!o.trim()){c("Please enter a voucher code.");return}r(!0),c("");try{let S=await Ae(o);e(S)}catch(S){c(S.message||"An unknown error occurred.")}finally{r(!1)}},children:[te("div",{className:"mb-4",children:[F("label",{htmlFor:"voucher",className:"block text-sm font-medium text-gray-700",children:"Enter Voucher Code"}),te("div",{className:"mt-1 relative rounded-md shadow-sm",children:[F("div",{className:"pointer-events-none absolute inset-y-0 left-0 pl-3 flex items-center",children:F(X,{className:"h-5 w-5 text-gray-400"})}),F("input",{type:"text",id:"voucher",value:o,onChange:d=>t(d.target.value.toUpperCase()),className:"block w-full rounded-md border-gray-300 pl-10 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"SULIT-XXXXXX",disabled:s})]})]}),a&&F("p",{className:`text-red-500 text-sm mb-4 text-center ${a?"animate-shake":""}`,children:a}),F("button",{type:"submit",disabled:s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400",children:s?"Connecting...":"Connect with Voucher"})]}),te("div",{className:"mt-6 flex items-center",children:[F("div",{className:"flex-grow border-t border-gray-300"}),F("span",{className:"flex-shrink mx-4 text-gray-500",children:"OR"}),F("div",{className:"flex-grow border-t border-gray-300"})]}),te("div",{className:"mt-6 text-center",children:[F("button",{onClick:async()=>{r(!0),c("");try{let d=await Ge();e(d)}catch(d){c(d.message||"An unknown error occurred.")}finally{r(!1)}},disabled:s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:bg-green-400",children:s?"Connecting...":"Start 15 Minute Session (Coin)"}),F("p",{className:"text-xs text-gray-500 mt-2",children:"Activates a timed session, just like inserting a coin."})]})]})},st=mo;import{useState as Ne}from"react";import{GoogleGenAI as po}from"@google/genai";var ie=null,at=()=>ie||(process.env.API_KEY?(ie=new po({apiKey:process.env.API_KEY}),ie):(console.warn("Gemini API key not found in environment variables. Wi-Fi Name Generator will be disabled."),null)),rt=()=>{at()},nt=async e=>{let o=at();if(!o)throw new Error("Gemini client not initialized. Is API_KEY set in environment?");try{return(await o.models.generateContent({model:"gemini-2.5-flash",contents:`Generate a funny, creative, or cool Wi-Fi network name (SSID). The name should be based on this theme: "${e}". The name must be 32 characters or less and contain only letters, numbers, and basic symbols. Just return the name itself, with no extra text or quotation marks.`,config:{maxOutputTokens:20,temperature:.9}})).text.trim()||`SULIT ${e}`}catch(t){return console.error("Error generating Wi-Fi name with Gemini:",t),"SULIT WIFI Zone"}};import{jsx as it}from"react/jsx-runtime";var uo=e=>it("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:it("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0015 0m-15 0a7.5 7.5 0 1115 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077l1.414-1.414M6.077 8.457l1.414 1.414m0 0L10.5 12m-2.01 2.01l-1.414 1.414M17.923 8.457l-1.414 1.414m0 0L13.5 12m2.01 2.01l1.414 1.414M12 6.75v.007v.007v.007v.007v.007"})}),ye=uo;import{jsx as oe,jsxs as ke}from"react/jsx-runtime";var go=({onNameGenerated:e})=>{let[o,t]=Ne(""),[s,r]=Ne(!1),[a,c]=Ne("");return ke("div",{className:"mt-6 p-4 border border-dashed border-gray-300 rounded-lg",children:[oe("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"Creative SSID Generator"}),oe("p",{className:"text-sm text-gray-500 mb-4",children:'Feeling creative? Enter a theme (e.g., "space cats", "80s retro") and let AI suggest a fun Wi-Fi name for you to set in the admin panel.'}),ke("div",{className:"flex items-center space-x-2",children:[oe("input",{type:"text",value:o,onChange:u=>t(u.target.value),placeholder:"Enter a theme...",className:"flex-grow block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",disabled:s}),ke("button",{onClick:async()=>{if(!o.trim()){c("Please enter a theme or keyword.");return}r(!0),c("");try{let u=await nt(o);e(u)}catch(u){c("Could not generate name. Please try again."),console.error(u)}finally{r(!1)}},disabled:s,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-300",children:[s?oe(ye,{className:"animate-spin h-5 w-5 mr-2"}):oe(ye,{className:"h-5 w-5 mr-2"}),"Generate"]})]}),a&&oe("p",{className:"text-red-500 text-sm mt-2",children:a})]})},dt=go;import{jsx as lt}from"react/jsx-runtime";var ho=e=>lt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:lt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 017.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 011.06 0z"})}),Se=ho;import{jsx as M,jsxs as q}from"react/jsx-runtime";var vo=()=>{let[e,o]=ae(null),[t,s]=ae(!0),[r,a]=ae(null),[c,h]=ae("SULIT WIFI"),[u,d]=ae(""),S=async()=>{try{let l=await Le();o(l)}catch(l){console.error("Failed to check session:",l)}finally{s(!1)}},C=async()=>{try{let l=await Re();h(l.ssid),rt()}catch(l){console.error("Failed to fetch settings:",l)}};fo(()=>{C(),S()},[]);let I=async()=>{s(!0);try{await Ve(),o(null)}catch(l){a(l.message)}finally{s(!1)}};return t?M("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:M(Se,{className:"w-16 h-16 text-indigo-500 animate-pulse"})}):q("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center items-center p-4",children:[q("main",{className:"w-full max-w-md bg-white rounded-lg shadow-xl p-8 space-y-6",children:[q("div",{className:"text-center",children:[M(Se,{className:"mx-auto h-12 w-auto text-indigo-600"}),q("h1",{className:"mt-4 text-3xl font-extrabold tracking-tight text-gray-900",children:["Welcome to ",c]})]}),e?q("div",{className:"animate-fade-in",children:[M("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-2",children:"Connected!"}),M("p",{className:"text-center text-gray-600 mb-6",children:"Time Remaining:"}),M(ot,{initialRemainingTime:e.remainingTime,onExpire:()=>o(null)}),M("button",{onClick:I,className:"mt-8 w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Disconnect"})]}):M(st,{onConnect:o}),r&&M("p",{className:"text-red-500 text-sm mt-4 text-center",children:r}),!e&&M(dt,{onNameGenerated:d}),u&&!e&&q("div",{className:"mt-4 p-3 bg-indigo-50 border border-indigo-200 rounded-md text-center animate-fade-in-slow",children:[M("p",{className:"text-sm text-indigo-700",children:"How about this name?"}),M("p",{className:"font-bold text-lg text-indigo-900",children:u})]})]}),q("footer",{className:"mt-8 text-center text-gray-500 text-sm",children:[M("p",{children:"Powered by SULIT Hotspot Solutions"}),M("p",{className:"mt-1",children:"Admin Panel v1.1.0"})]})]})},ct=vo;import{useState as Ce}from"react";import{jsx as mt}from"react/jsx-runtime";var bo=e=>mt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:mt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H4.5a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"})}),de=bo;import{jsx as pt}from"react/jsx-runtime";var xo=e=>pt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:pt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),ut=xo;import{jsx as W,jsxs as re}from"react/jsx-runtime";var wo=({onLoginSuccess:e})=>{let[o,t]=Ce(""),[s,r]=Ce(!1),[a,c]=Ce("");return W("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center items-center p-4",children:re("div",{className:"w-full max-w-sm bg-white rounded-lg shadow-md p-8",children:[re("div",{className:"text-center mb-8",children:[W(ut,{className:"mx-auto h-12 w-auto text-gray-400"}),W("h1",{className:"mt-4 text-2xl font-bold text-gray-800",children:"Admin Login"}),W("p",{className:"text-sm text-gray-500",children:"SULIT WIFI Control Panel"})]}),re("form",{onSubmit:async u=>{u.preventDefault(),r(!0),c("");try{let d=await Me(o);localStorage.setItem("admin_token",d),e()}catch(d){c(d.message||"Login failed.")}finally{r(!1)}},className:"space-y-6",children:[re("div",{children:[W("label",{htmlFor:"password-admin",className:"sr-only",children:"Password"}),re("div",{className:"relative",children:[W("div",{className:"pointer-events-none absolute inset-y-0 left-0 pl-3 flex items-center",children:W(de,{className:"h-5 w-5 text-gray-400"})}),W("input",{id:"password-admin",name:"password",type:"password",value:o,onChange:u=>t(u.target.value),required:!0,className:"block w-full rounded-md border-gray-300 pl-10 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Password",disabled:s})]})]}),a&&W("p",{className:`text-red-500 text-sm text-center ${a?"animate-shake":""}`,children:a}),W("div",{children:W("button",{type:"submit",disabled:s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400",children:s?"Signing in...":"Sign In"})})]})]})})},gt=wo;import{useState as es}from"react";import{useState as ce,useEffect as Io}from"react";import{jsx as ht}from"react/jsx-runtime";var yo=e=>ht("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:ht("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.286 .94c-.622.58-1.352.924-2.147.924-1.449 0-2.733-.784-3.463-2.019a3.001 3.001 0 004.582-2.316m3.545 5.332a9.094 9.094 0 013.741-.479 3 3 0 01-4.682-2.72m-7.286 .94c.622.58 1.352.924 2.147.924 1.449 0 2.733-.784 3.463-2.019a3.001 3.001 0 01-4.582-2.316m0 0a3.001 3.001 0 00-3.445-2.592 3.001 3.001 0 00-2.592 3.445 3.001 3.001 0 002.316 4.582m0 0a3.001 3.001 0 003.445 2.592 3.001 3.001 0 002.592-3.445"})}),ft=yo;import{jsx as vt,jsxs as ko}from"react/jsx-runtime";var No=e=>ko("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[vt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 21v-1.5m1.5.75H12m6 0h-1.5m-1.5-.75V21m-6-18v1.5m-1.5.75H12m-6 0h1.5m1.5.75V3m6 18v-1.5m1.5.75H12m6 0h-1.5m-1.5-.75V21m-6-18v1.5m-1.5.75H12m-6 0h1.5m1.5.75V3"}),vt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 7.5h9v9h-9z"})]}),le=No;import{jsx as bt,jsxs as Co}from"react/jsx-runtime";var So=e=>Co("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[bt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 013 3v9a3 3 0 01-3-3h-9a3 3 0 01-3-3v-9a3 3 0 013-3h9z"}),bt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 7.5h.008v.008H15V7.5zm0 2.25h.008v.008H15v-.008zm0 2.25h.008v.008H15v-.008zm-2.25-4.5h.008v.008H12.75V7.5zm0 2.25h.008v.008H12.75v-.008zm0 2.25h.008v.008H12.75v-.008zm-2.25-4.5h.008v.008H10.5V7.5zm0 2.25h.008v.008H10.5v-.008zm0 2.25h.008v.008H10.5v-.008z"})]}),xt=So;import{jsx as wt}from"react/jsx-runtime";var Po=e=>wt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:wt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"})}),yt=Po;import{jsx as P,jsxs as R}from"react/jsx-runtime";var Pe=({title:e,value:o,icon:t})=>R("div",{className:"bg-white p-6 rounded-lg shadow-md flex items-center",children:[P("div",{className:"bg-indigo-500 rounded-full p-3 mr-4 text-white",children:P(t,{className:"h-6 w-6"})}),R("div",{children:[P("p",{className:"text-sm text-gray-600",children:e}),P("p",{className:"text-2xl font-bold text-gray-900",children:o})]})]}),Nt=({value:e,total:o,unit:t})=>{let s=o>0?e/o*100:0;return R("div",{children:[R("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[P("span",{children:`${e} ${t}`}),P("span",{children:`${o} ${t}`})]}),P("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:P("div",{className:"bg-green-500 h-2.5 rounded-full",style:{width:`${s}%`}})})]})},Lo=()=>{let[e,o]=ce(null),[t,s]=ce(null),[r,a]=ce(!0),[c,h]=ce("");return Io(()=>{(async()=>{a(!0),h("");try{let[d,S]=await Promise.all([Ee(),Te()]);o(d),s(S)}catch(d){console.error("Failed to load dashboard data",d),h(d.message||"Could not load dashboard data.")}finally{a(!1)}})()},[]),r?P("div",{children:"Loading dashboard..."}):R("div",{className:"animate-fade-in space-y-8",children:[P("h1",{className:"text-3xl font-bold text-gray-800",children:"Dashboard"}),c&&P("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:c}),R("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[P(Pe,{title:"Active Sessions",value:e?.activeSessions??"N/A",icon:ft}),P(Pe,{title:"Vouchers Used",value:e?.totalVouchersUsed??"N/A",icon:X}),P(Pe,{title:"Vouchers Available",value:e?.totalVouchersAvailable??"N/A",icon:X})]}),R("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"System Status"}),t?R("div",{className:"space-y-6",children:[R("div",{children:[R("h3",{className:"font-medium text-gray-800 flex items-center mb-2",children:[P(le,{className:"h-5 w-5 mr-2"})," CPU"]}),R("p",{className:"text-sm text-gray-600",children:[t.cpu.model," (",t.cpu.cores," cores)"]})]}),R("div",{children:[R("h3",{className:"font-medium text-gray-800 flex items-center mb-2",children:[P(xt,{className:"h-5 w-5 mr-2"})," RAM Usage"]}),P(Nt,{value:t.ram.usedMb,total:t.ram.totalMb,unit:"MB"})]}),R("div",{children:[R("h3",{className:"font-medium text-gray-800 flex items-center mb-2",children:[P(yt,{className:"h-5 w-5 mr-2"})," Disk Usage"]}),P(Nt,{value:t.disk.usedMb,total:t.disk.totalMb,unit:"MB"})]})]}):P("p",{children:"Could not load system information."})]})]})},kt=Lo;import{useState as se,useEffect as Ro}from"react";import{jsx as St}from"react/jsx-runtime";var Vo=e=>St("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:St("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5.25v-1.5A2.25 2.25 0 0111.25 1.5h1.5A2.25 2.25 0 0115 3.75v1.5m-5.625 0H18a2.25 2.25 0 012.25 2.25v10.5A2.25 2.25 0 0118 20.25H6.75A2.25 2.25 0 014.5 18V7.5a2.25 2.25 0 012.25-2.25H9.375"})}),Ct=Vo;import{jsx as L,jsxs as U}from"react/jsx-runtime";var Ao=()=>{let[e,o]=se([]),[t,s]=se(!0),[r,a]=se(60),[c,h]=se(!1),[u,d]=se(""),[S,C]=se(""),I=async()=>{s(!0),C("");try{let f=await Fe();o(f)}catch(f){console.error(f),C(f.message||"Could not fetch vouchers.")}finally{s(!1)}};Ro(()=>{I()},[]);let l=async()=>{h(!0),C("");try{await He(r*60),await I()}catch(f){console.error(f),C(f.message||"Could not generate voucher.")}finally{h(!1)}},x=f=>{navigator.clipboard.writeText(f),d(f),setTimeout(()=>d(""),2e3)};return U("div",{className:"animate-fade-in space-y-6",children:[L("h1",{className:"text-3xl font-bold text-gray-800",children:"Voucher Manager"}),S&&L("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:S}),U("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[L("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Generate New Voucher"}),U("div",{className:"flex items-center space-x-4",children:[U("div",{children:[L("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration (minutes)"}),L("input",{type:"number",id:"duration",value:r,onChange:f=>a(parseInt(f.target.value,10)),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",min:"1"})]}),L("button",{onClick:l,disabled:c,className:"self-end py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-300",children:c?"Generating...":"Generate"})]})]}),U("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[L("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Available Vouchers"}),t?L("p",{children:"Loading vouchers..."}):L("div",{className:"overflow-x-auto",children:U("table",{className:"min-w-full divide-y divide-gray-200",children:[L("thead",{className:"bg-gray-50",children:U("tr",{children:[L("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),L("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),L("th",{scope:"col",className:"relative px-6 py-3",children:L("span",{className:"sr-only",children:"Copy"})})]})}),L("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(f=>U("tr",{children:[L("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900",children:f.code}),U("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[f.duration/60," minutes"]}),L("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:U("button",{onClick:()=>x(f.code),className:"text-indigo-600 hover:text-indigo-900 flex items-center",children:[L(Ct,{className:"h-5 w-5 mr-1"}),u===f.code?"Copied!":"Copy"]})})]},f.code))})]})})]})]})},Pt=Ao;import{useState as z,useEffect as Eo}from"react";import{jsx as It}from"react/jsx-runtime";var Go=e=>It("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:It("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),me=Go;import{jsx as Lt}from"react/jsx-runtime";var Mo=e=>Lt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:Lt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.471-2.471a.563.563 0 01.884 0l1.178 1.178a.563.563 0 010 .884l-2.471 2.471m-4.243-4.243L6.75 9.25l-1.414-1.414a.563.563 0 010-.884l1.178-1.178a.563.563 0 01.884 0l2.693 2.693M11.42 15.17l-4.243-4.243"})}),pe=Mo;import{jsx as i,jsxs as w}from"react/jsx-runtime";var To=()=>{let[e,o]=z(null),[t,s]=z(null),[r,a]=z(!0),[c,h]=z(!1),[u,d]=z(""),[S,C]=z(""),[I,l]=z(""),[x,f]=z(""),[$,V]=z(""),[g,y]=z("general");Eo(()=>{(async()=>{a(!0),C("");try{let[G,J]=await Promise.all([De(),Be()]);o(G),s(J)}catch(G){C(G.message)}finally{a(!1)}})()},[]);let H=b=>{let{name:G,value:J,type:ee,checked:ve}=b.target,be=ee==="checkbox"?ve:ee==="number"?parseInt(J,10)||0:J;o(xe=>({portalTitle:"",coinSlotEnabled:!1,coinPulseValue:0,...xe,[G]:be}))},m=b=>{let{name:G,value:J,type:ee,checked:ve}=b.target,be=ee==="checkbox"?ve:parseInt(J,10)||0;s(xe=>({coinPin:0,relayPin:0,statusLedPin:0,coinSlotActiveLow:!0,...xe,[G]:be}))},A=async b=>{if(b.preventDefault(),I||x){if(I!==x){V("Passwords do not match."),y("security");return}if(I.length>0&&I.length<6){V("Password must be at least 6 characters long."),y("security");return}}if(V(""),!e||!t){C("Settings data is not loaded, cannot save.");return}h(!0),d(""),C("");try{let G={portalTitle:e.portalTitle,coinSlotEnabled:e.coinSlotEnabled,coinPulseValue:e.coinPulseValue};I&&(G.adminPassword=I);let J=We(G),ee=Ue(t);await Promise.all([J,ee]),d("Settings saved successfully."),l(""),f("")}catch(G){C(G.message)}finally{h(!1)}},D=[{name:"general",label:"General",icon:pe},{name:"gpio",label:"Hardware (GPIO)",icon:le},{name:"security",label:"Security",icon:de}];return r?i("div",{children:"Loading settings..."}):S&&!e&&!t?i("div",{className:"bg-red-100 p-4 rounded-md text-red-700",children:"Could not load settings data. Please ensure the server is running and the database is connected."}):w("div",{className:"animate-fade-in space-y-6",children:[i("h1",{className:"text-3xl font-bold text-gray-800",children:"System Settings"}),u&&i("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",children:u}),S&&i("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:S}),w("form",{onSubmit:A,children:[w("div",{className:"mb-6",children:[w("div",{className:"sm:hidden",children:[i("label",{htmlFor:"tabs",className:"sr-only",children:"Select a tab"}),i("select",{id:"tabs",name:"tabs",className:"block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500",onChange:b=>y(b.target.value),value:g,children:D.map(b=>i("option",{value:b.name,children:b.label},b.name))})]}),i("div",{className:"hidden sm:block",children:i("div",{className:"border-b border-gray-200",children:i("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:D.map(b=>w("button",{type:"button",onClick:()=>y(b.name),className:`${g===b.name?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} flex items-center whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:[i(b.icon,{className:"mr-2 h-5 w-5"}),b.label]},b.name))})})})]}),w("div",{className:g==="general"?"space-y-6":"hidden",children:[w("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[i("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Portal Settings"}),w("div",{children:[i("label",{htmlFor:"portalTitle",className:"block text-sm font-medium text-gray-700",children:"Portal Title"}),i("input",{type:"text",id:"portalTitle",name:"portalTitle",value:e?.portalTitle||"",onChange:H,className:"mt-1 block w-full max-w-lg rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]})]}),w("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[i("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Coin Slot"}),w("div",{className:"space-y-4",children:[w("label",{className:"flex items-center",children:[i("input",{type:"checkbox",name:"coinSlotEnabled",checked:e?.coinSlotEnabled||!1,onChange:H,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),i("span",{className:"ml-2 font-medium text-gray-900",children:"Enable Coin Slot"})]}),e?.coinSlotEnabled&&w("div",{children:[i("label",{htmlFor:"coinPulseValue",className:"block text-sm font-medium text-gray-700",children:"Minutes per Coin/Pulse"}),i("input",{type:"number",id:"coinPulseValue",name:"coinPulseValue",value:e?.coinPulseValue||15,onChange:H,className:"mt-1 block w-full max-w-xs rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",min:"1"}),i("p",{className:"text-xs text-gray-500 mt-1",children:"How many minutes of internet to grant per coin insertion."})]})]})]})]}),i("div",{className:g==="gpio"?"space-y-6":"hidden",children:w("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[i("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"GPIO Pin Configuration"}),w("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[w("div",{children:[i("label",{htmlFor:"coinPin",className:"block text-sm font-medium text-gray-700",children:"Coin Slot Pin (BCM)"}),i("input",{type:"number",id:"coinPin",name:"coinPin",value:t?.coinPin||0,onChange:m,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]}),w("div",{children:[i("label",{htmlFor:"relayPin",className:"block text-sm font-medium text-gray-700",children:"Relay Pin (BCM)"}),i("input",{type:"number",id:"relayPin",name:"relayPin",value:t?.relayPin||0,onChange:m,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]}),w("div",{children:[i("label",{htmlFor:"statusLedPin",className:"block text-sm font-medium text-gray-700",children:"Status LED Pin (BCM)"}),i("input",{type:"number",id:"statusLedPin",name:"statusLedPin",value:t?.statusLedPin||0,onChange:m,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]})]}),w("div",{className:"mt-4",children:[w("label",{className:"flex items-center",children:[i("input",{type:"checkbox",name:"coinSlotActiveLow",checked:t?.coinSlotActiveLow||!1,onChange:m,className:"h-4 w-4 rounded border-gray-300 text-indigo-600"}),i("span",{className:"ml-2 text-sm font-medium text-gray-900",children:"Coin slot is active-low"})]}),i("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Check this if your coin acceptor sends a LOW signal on coin insert. This is the most common type."})]}),w("div",{className:"mt-4 bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:[i("p",{className:"font-bold text-blue-800",children:"Real-time Updates"}),i("p",{className:"text-sm text-blue-700",children:"GPIO settings are applied instantly when you save. No server restart is needed."})]})]})}),i("div",{className:g==="security"?"space-y-6":"hidden",children:w("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[i("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Change Admin Password"}),i("p",{className:"text-sm text-gray-500 mb-4",children:"Leave fields blank to keep the current password."}),w("div",{className:"space-y-4 max-w-lg",children:[w("div",{children:[i("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),i("input",{type:"password",id:"password",value:I,onChange:b=>l(b.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]}),w("div",{children:[i("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),i("input",{type:"password",id:"confirmPassword",value:x,onChange:b=>f(b.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]}),$&&i("p",{className:"text-red-500 text-sm",children:$})]})]})}),i("div",{className:"mt-8 pt-5 border-t border-gray-200",children:i("div",{className:"flex justify-end",children:w("button",{type:"submit",disabled:c,className:"inline-flex items-center py-2 px-6 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400",children:[i(me,{className:"h-5 w-5 mr-2"}),c?"Saving...":"Save All Settings"]})})})]})]})},Vt=To;import{useState as K,useEffect as Bo}from"react";import{jsx as Rt}from"react/jsx-runtime";var Fo=e=>Rt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:Rt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16.5V9.75m0 0l-3.75 3.75M12 9.75l3.75 3.75M3.75 13.5a9 9 0 1116.5 0 9 9 0 01-16.5 0z"})}),ue=Fo;import{jsx as At}from"react/jsx-runtime";var Ho=e=>At("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:At("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.03 1.122 0 1.131.094 1.976 1.057 1.976 2.192V7.5m-9 0h9v9.75a1.5 1.5 0 01-1.5 1.5H9.75a1.5 1.5 0 01-1.5-1.5V7.5z"})}),Gt=Ho;import{jsx as Mt}from"react/jsx-runtime";var Do=e=>Mt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:Mt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})}),Et=Do;import{jsx as Tt}from"react/jsx-runtime";var Wo=e=>Tt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:Tt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0a48.11 48.11 0 00-7.5 0"})}),Ft=Wo;import{jsx as N,jsxs as E}from"react/jsx-runtime";var Uo=()=>{let[e,o]=K(null),[t,s]=K([]),[r,a]=K(!0),[c,h]=K(!0),[u,d]=K(!1),[S,C]=K(""),[I,l]=K(""),x=async()=>{a(!0);try{let m=await ze();o(m)}catch(m){l(m.message||"Could not fetch update status."),console.error(m)}finally{a(!1)}},f=async()=>{h(!0);try{let m=await $e();s(m)}catch(m){l(m.message||"Could not load backups.")}finally{h(!1)}};Bo(()=>{x(),f()},[]);let $=()=>{C(""),l("")},V=async()=>{if(window.confirm("This will update the application from the main GitHub repository. The server will restart. Are you sure you want to proceed?")){$(),d(!0);try{let m=await Oe();C(m.message)}catch(m){l(m.message),d(!1)}}},g=async()=>{$(),d(!0);try{let m=await je();C(m.message),await f()}catch(m){l(m.message)}finally{d(!1)}},y=async m=>{if(window.confirm(`Are you sure you want to restore from "${m}"? This will overwrite all current settings and vouchers.`)){$(),d(!0);try{let A=await Je(m);C(A.message+" The page will now reload."),setTimeout(()=>window.location.reload(),3e3)}catch(A){l(A.message),d(!1)}}},H=async m=>{if(window.confirm(`Are you sure you want to permanently delete the backup file "${m}"?`)){$(),d(!0);try{let A=await _e(m);C(A.message),s(D=>D.filter(b=>b!==m))}catch(A){l(A.message)}finally{d(!1)}}};return E("div",{className:"animate-fade-in space-y-6",children:[N("h1",{className:"text-3xl font-bold text-gray-800",children:"Updater & Backup"}),S&&N("div",{className:`px-4 py-3 rounded relative ${u&&S.includes("Update process started")?"bg-blue-100 border border-blue-400 text-blue-700":"bg-green-100 border border-green-400 text-green-700"}`,children:S}),I&&N("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:I}),E("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[N("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Software Update"}),r?N("p",{children:"Checking for updates..."}):e?E("div",{className:"space-y-4",children:[N("div",{className:`p-4 rounded-md ${e.isUpdateAvailable?"bg-blue-50 border border-blue-200":"bg-green-50 border border-green-200"}`,children:N("p",{className:`font-bold ${e.isUpdateAvailable?"text-blue-800":"text-green-800"}`,children:e.statusText})}),E("div",{className:"text-sm text-gray-600 space-y-1",children:[E("p",{children:[N("strong",{children:"Current Version:"})," ",N("span",{className:"font-mono",children:e.localCommit.substring(0,7)})]}),e.remoteCommit&&e.remoteCommit!=="N/A"&&E("p",{children:[N("strong",{children:"Latest Version:"})," ",N("span",{className:"font-mono",children:e.remoteCommit.substring(0,7)})]})]}),E("button",{onClick:V,disabled:!e.isUpdateAvailable||u,className:"flex items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed",children:[N(ue,{className:"h-5 w-5 mr-2"}),u?"Updating...":"Update Now"]})]}):N("p",{className:"text-red-500",children:"Could not retrieve update status. Ensure 'git' is installed on the server."})]}),E("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[N("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Backup & Restore"}),N("p",{className:"text-sm text-gray-500 mb-4",children:"Create a backup of your settings and vouchers. Restore will overwrite existing data."}),N("div",{className:"flex space-x-4",children:E("button",{onClick:g,disabled:u,className:"flex items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-200",children:[N(Gt,{className:"h-5 w-5 mr-2"}),u?"Processing...":"Create Backup"]})})]}),E("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[N("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Manage Backups"}),c?N("p",{children:"Loading backups..."}):t.length>0?N("div",{className:"space-y-3",children:t.map(m=>E("div",{className:"flex items-center justify-between p-3 border rounded-md bg-gray-50",children:[N("span",{className:"font-mono text-sm text-gray-800",children:m}),E("div",{className:"flex space-x-2",children:[E("button",{onClick:()=>y(m),disabled:u,className:"flex items-center text-sm text-blue-600 hover:text-blue-800 disabled:text-gray-400",children:[N(Et,{className:"h-4 w-4 mr-1"}),"Restore"]}),E("button",{onClick:()=>H(m),disabled:u,className:"flex items-center text-sm text-red-600 hover:text-red-800 disabled:text-gray-400",children:[N(Ft,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]},m))}):N("div",{className:"border rounded-lg p-4 text-center text-gray-500",children:"No backups found."})]})]})},Ht=Uo;import{useState as Y,useEffect as Oo,useMemo as Wt}from"react";import{jsx as Dt}from"react/jsx-runtime";var zo=e=>Dt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:Dt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6.878V6a2.25 2.25 0 012.25-2.25h7.5A2.25 2.25 0 0118 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 004.5 9v.878m13.5-3A2.25 2.25 0 0119.5 9v.878m0 0a2.246 2.246 0 00-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0121 12v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6c0-.98.626-1.813 1.5-2.122"})}),ge=zo;import{jsx as n,jsxs as k}from"react/jsx-runtime";var he=e=>/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/.test(e),Ie=e=>{if(!he(e))return null;let o=e.split(".");return o.length!==4?null:`${o[0]}.${o[1]}.${o[2]}`},$o=()=>{let[e,o]=Y(null),[t,s]=Y([]),[r,a]=Y(""),[c,h]=Y(!0),[u,d]=Y(!1),[S,C]=Y(""),[I,l]=Y("");Oo(()=>{(async()=>{h(!0),l("");try{let[y,H,m]=await Promise.all([Xe(),Ke(),Ye()]);o(y),s(H),a(m.name)}catch(y){l(y.message)}finally{h(!1)}})()},[]);let x=Wt(()=>{if(!e)return{};let g={};e.ssid||(g.ssid="SSID cannot be empty."),e.security==="wpa2"&&(!e.password||e.password.length<8)&&(g.password="Password must be at least 8 characters."),he(e.hotspotIpAddress)||(g.hotspotIpAddress="Invalid IP format.");let y=Ie(e.hotspotIpAddress);return e.hotspotDhcpServer.enabled&&(he(e.hotspotDhcpServer.start)?y&&Ie(e.hotspotDhcpServer.start)!==y&&(g.dhcpStart="Must be on the same subnet as the Hotspot IP."):g.dhcpStart="Invalid IP format.",he(e.hotspotDhcpServer.end)?y&&Ie(e.hotspotDhcpServer.end)!==y&&(g.dhcpEnd="Must be on the same subnet as the Hotspot IP."):g.dhcpEnd="Invalid IP format."),g},[e]),f=Wt(()=>Object.keys(x).length===0,[x]),$=async g=>{if(g.preventDefault(),!(!e||!f)){d(!0),C(""),l("");try{let y=await qe(e);C(y.message)}catch(y){l(y.message)}finally{d(!1)}}},V=g=>{let{name:y,value:H,type:m}=g.target;if(y.startsWith("dhcp.")){let A=y.split(".")[1];o(D=>{if(!D)return null;let b=m==="checkbox",G=g.target.checked;return{...D,hotspotDhcpServer:{...D.hotspotDhcpServer,[A]:b?G:H}}})}else o(A=>{if(!A)return null;let D={...A,[y]:H};return y==="security"&&H==="open"&&(D.password=""),D})};return c?n("div",{children:"Loading network configuration..."}):k("div",{className:"animate-fade-in space-y-6",children:[n("h1",{className:"text-3xl font-bold text-gray-800",children:"Network Configuration"}),S&&n("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",children:S}),I&&n("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:I}),k("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[n("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Available Interfaces"}),t.length>0?n("div",{className:"space-y-4",children:t.map(g=>k("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[k("div",{className:"flex items-center",children:[n(ge,{className:"h-6 w-6 mr-3 text-gray-500"}),k("div",{children:[n("p",{className:"font-mono font-bold text-gray-800",children:g.name}),n("p",{className:"text-sm text-gray-600",children:g.ip4||"No IPv4 Address"})]})]}),n("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${g.status==="UP"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})]},g.name))}):n("p",{children:"Could not load interface information."})]}),e?k("form",{onSubmit:$,className:"space-y-6",children:[k("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[n("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Hotspot Configuration"}),k("div",{className:"space-y-6",children:[k("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[n("label",{className:"block text-sm font-medium text-gray-500",children:"Detected WAN (Internet) Interface"}),n("p",{className:"text-lg font-bold font-mono text-gray-800",children:r||"Unknown"})]}),k("div",{children:[n("label",{htmlFor:"hotspotInterface",className:"block text-sm font-medium text-gray-700",children:"Hotspot Interface"}),n("select",{id:"hotspotInterface",name:"hotspotInterface",value:e.hotspotInterface,onChange:V,className:"mt-1 block w-full max-w-sm rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:t.map(g=>n("option",{value:g.name,children:g.name},g.name))}),n("p",{className:"text-xs text-gray-500 mt-1",children:"The interface for broadcasting Wi-Fi to users."})]}),k("div",{className:"border-t pt-6",children:[n("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Wi-Fi Hotspot Settings"}),k("div",{children:[n("label",{htmlFor:"ssid",className:"block text-sm font-medium text-gray-700",children:"Wi-Fi Name (SSID)"}),n("input",{type:"text",id:"ssid",name:"ssid",value:e.ssid,onChange:V,className:`mt-1 block w-full max-w-sm rounded-md border-gray-300 shadow-sm ${x.ssid?"border-red-500":""}`}),x.ssid&&n("p",{className:"text-xs text-red-600 mt-1",children:x.ssid})]}),k("div",{className:"mt-4",children:[n("label",{htmlFor:"security",className:"block text-sm font-medium text-gray-700",children:"Security"}),k("select",{id:"security",name:"security",value:e.security,onChange:V,className:"mt-1 block w-full max-w-sm rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[n("option",{value:"open",children:"Open (No Password)"}),n("option",{value:"wpa2",children:"WPA2 (Recommended)"})]})]}),e.security==="wpa2"&&k("div",{className:"mt-4",children:[n("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),n("input",{type:"password",id:"password",name:"password",value:e.password,onChange:V,className:`mt-1 block w-full max-w-sm rounded-md border-gray-300 shadow-sm ${x.password?"border-red-500":""}`}),x.password&&n("p",{className:"text-xs text-red-600 mt-1",children:x.password})]})]}),k("div",{className:"border-t pt-6",children:[n("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"IP & DHCP Settings"}),k("div",{children:[n("label",{htmlFor:"hotspotIpAddress",className:"block text-sm font-medium text-gray-700",children:"Hotspot Static IP Address"}),n("input",{type:"text",id:"hotspotIpAddress",name:"hotspotIpAddress",value:e.hotspotIpAddress,onChange:V,className:`mt-1 block w-full max-w-sm rounded-md border-gray-300 shadow-sm ${x.hotspotIpAddress?"border-red-500":""}`}),x.hotspotIpAddress&&n("p",{className:"text-xs text-red-600 mt-1",children:x.hotspotIpAddress}),n("p",{className:"text-xs text-gray-500 mt-1",children:"The IP address of this device on the hotspot network."})]}),k("div",{className:"border-t pt-6 mt-6",children:[k("label",{className:"flex items-center",children:[n("input",{type:"checkbox",name:"dhcp.enabled",checked:e.hotspotDhcpServer.enabled,onChange:V,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),n("span",{className:"ml-2 font-medium text-gray-900",children:"Enable DHCP Server"})]}),n("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"Automatically assign IP addresses to users on the hotspot network."})]}),e.hotspotDhcpServer.enabled&&k("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pl-6 mt-4 border-l-2 border-indigo-100",children:[k("div",{children:[n("label",{htmlFor:"dhcp.start",className:"block text-sm font-medium text-gray-700",children:"DHCP Start"}),n("input",{type:"text",id:"dhcp.start",name:"dhcp.start",value:e.hotspotDhcpServer.start,onChange:V,className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${x.dhcpStart?"border-red-500":""}`}),x.dhcpStart&&n("p",{className:"text-xs text-red-600 mt-1",children:x.dhcpStart})]}),k("div",{children:[n("label",{htmlFor:"dhcp.end",className:"block text-sm font-medium text-gray-700",children:"DHCP End"}),n("input",{type:"text",id:"dhcp.end",name:"dhcp.end",value:e.hotspotDhcpServer.end,onChange:V,className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${x.dhcpEnd?"border-red-500":""}`}),x.dhcpEnd&&n("p",{className:"text-xs text-red-600 mt-1",children:x.dhcpEnd})]}),k("div",{children:[n("label",{htmlFor:"dhcp.lease",className:"block text-sm font-medium text-gray-700",children:"Lease Time"}),n("input",{type:"text",id:"dhcp.lease",name:"dhcp.lease",value:e.hotspotDhcpServer.lease,onChange:V,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]})]})]})]})]}),k("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[n("p",{className:"font-bold text-yellow-800",children:"Warning"}),n("p",{className:"text-sm text-yellow-700",children:"Applying changes will restart your Wi-Fi and networking services, briefly disconnecting all users. Incorrect settings can make your device inaccessible."})]}),n("button",{type:"submit",disabled:u||!f,className:"py-2 px-6 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed",children:u?"Applying...":"Save & Apply All Changes"})]}):n("p",{children:"Could not load hotspot configuration."})]})},Bt=$o;import{useState as ne,useEffect as Jo}from"react";import{jsx as Ut}from"react/jsx-runtime";var jo=e=>Ut("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:Ut("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.667 0l3.181-3.183m-11.667-11.667l3.181 3.183a8.25 8.25 0 0111.667 0l3.181-3.183"})}),zt=jo;import{jsx as O,jsxs as Z}from"react/jsx-runtime";var _o=()=>{let[e,o]=ne(""),[t,s]=ne(!0),[r,a]=ne(!1),[c,h]=ne(""),[u,d]=ne(""),S=async()=>{s(!0);try{let l=await Ze();o(l.html)}catch(l){d(l.message)}finally{s(!1)}};Jo(()=>{S()},[]);let C=async()=>{a(!0),h(""),d("");try{let l=await Qe(e);h(l.message)}catch(l){d(l.message)}finally{a(!1)}},I=async()=>{if(window.confirm("Are you sure you want to reset the portal HTML to its default?")){a(!0),h(""),d("");try{let l=await et();o(l.html),h("Portal HTML has been reset.")}catch(l){d(l.message)}finally{a(!1)}}};return t?O("div",{children:"Loading portal editor..."}):Z("div",{className:"animate-fade-in space-y-6",children:[O("h1",{className:"text-3xl font-bold text-gray-800",children:"Portal Editor"}),Z("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:[O("p",{className:"font-bold text-blue-800",children:"Note"}),O("p",{className:"text-sm text-blue-700",children:"This editor allows you to customize HTML content stored in the database. By default, this content is not displayed to the user, as the live portal is a dynamic React application. Further server customization is required to integrate this HTML."})]}),c&&O("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",children:c}),u&&O("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:u}),Z("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[Z("div",{className:"flex justify-between items-center mb-4",children:[O("h2",{className:"text-xl font-semibold text-gray-700",children:"Portal HTML"}),Z("div",{className:"flex space-x-2",children:[Z("button",{onClick:I,disabled:r,className:"flex items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-200",children:[O(zt,{className:"h-5 w-5 mr-2"}),"Reset to Default"]}),Z("button",{onClick:C,disabled:r,className:"flex items-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300",children:[O(me,{className:"h-5 w-5 mr-2"}),r?"Saving...":"Save Changes"]})]})]}),O("textarea",{value:e,onChange:l=>o(l.target.value),className:"w-full h-96 p-2 border border-gray-300 rounded-md font-mono text-sm",placeholder:"Enter portal HTML here..."})]})]})},Ot=_o;import{useState as jt,useEffect as Xo}from"react";var $t=e=>{try{let o=e.split(".")[1];if(!o)return{error:"Invalid JWT format"};let t=o.replace(/-/g,"+").replace(/_/g,"/"),s=t.length%4,r=t+"====".substring(s),a=decodeURIComponent(atob(r).split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(a)}catch(o){return console.error("Failed to decode JWT:",o),{error:"Failed to decode token. It might be malformed."}}};import{jsx as T,jsxs as B}from"react/jsx-runtime";var qo=()=>{let[e,o]=jt(null),[t,s]=jt(null);return Xo(()=>{let a=localStorage.getItem("admin_token");o(a),a&&s($t(a))},[]),B("div",{className:"animate-fade-in space-y-6",children:[T("h1",{className:"text-3xl font-bold text-gray-800",children:"Debug Information"}),B("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:[T("p",{className:"font-bold text-blue-800",children:"About this page"}),T("p",{className:"text-sm text-blue-700",children:"This page displays information about your current admin session token. It can help diagnose login issues related to token expiration or system clock problems on the server."})]}),B("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[T("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Authentication Token Details"}),(()=>{if(!e)return T("p",{className:"text-gray-600",children:"No token found in local storage. Please log in."});if(!t||t.error)return T("p",{className:"text-red-500",children:"Could not decode the token. It may be malformed."});let a=t.iat?new Date(t.iat*1e3).toLocaleString():"N/A",c=t.exp?new Date(t.exp*1e3).toLocaleString():"N/A",h=t.exp?new Date(t.exp*1e3)<new Date:!1;return B("div",{className:"space-y-4",children:[B("div",{children:[T("h3",{className:"font-semibold text-gray-700",children:"Decoded Token Payload:"}),T("pre",{className:"mt-1 p-3 bg-gray-100 rounded-md text-sm overflow-auto",children:JSON.stringify(t,null,2)})]}),B("div",{children:[T("h3",{className:"font-semibold text-gray-700",children:"Token Details:"}),B("ul",{className:"list-disc list-inside mt-1 text-sm",children:[B("li",{children:[T("strong",{children:"Issued At:"})," ",a]}),B("li",{children:[T("strong",{children:"Expires At:"})," ",c]}),B("li",{className:h?"text-red-600 font-bold":"text-green-600 font-bold",children:[T("strong",{children:"Status:"})," ",h?"Expired":"Valid"]})]})]}),B("div",{children:[T("h3",{className:"font-semibold text-gray-700",children:"Raw Token:"}),T("textarea",{readOnly:!0,value:e,className:"mt-1 p-2 w-full h-32 bg-gray-100 rounded-md text-xs font-mono border-gray-300"})]})]})})()]})]})},Jt=qo;import{jsx as _t}from"react/jsx-runtime";var Ko=e=>_t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:_t("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"})}),Xt=Ko;import{jsx as qt}from"react/jsx-runtime";var Yo=e=>qt("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:qt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25"})}),Kt=Yo;import{jsx as Yt,jsxs as Qo}from"react/jsx-runtime";var Zo=e=>Qo("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[Yt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.25 2.25h3.5m-3.5 0-2.25 2.25M10.25 2.25 12.5 4.5M13.75 2.25l2.25 2.25m-2.25-2.25L11.5 4.5m3.75 4.5a3.75 3.75 0 0 0-7.5 0h7.5zM12 18.75a3.75 3.75 0 0 0 3.75-3.75H8.25A3.75 3.75 0 0 0 12 18.75zM12 15V9"}),Yt("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12.75h-.75m18 0h.75m-14.25-6h-1.5m1.5 0V5.25m0 1.5L5.25 6m12 6.75h1.5m-1.5 0V5.25m0 1.5l3.75-1.5M4.5 17.25l-2.25 2.25m18-2.25 2.25 2.25M4.5 6.75 2.25 4.5m18 2.25L19.5 4.5"})]}),Zt=Zo;import{Fragment as os,jsx as p,jsxs as j}from"react/jsx-runtime";var Q=({href:e,icon:o,children:t})=>{let s=window.location.pathname;return j("a",{href:e,className:`flex items-center px-4 py-2 text-sm font-medium rounded-md ${s===e||s==="/admin"&&e==="/admin/dashboard"?"bg-indigo-600 text-white":"text-gray-300 hover:bg-indigo-500 hover:text-white"}`,children:[p(o,{className:"mr-3 h-6 w-6"}),t]})},ts=({onLogout:e})=>{let[o,t]=es(!1),s=()=>{let a=window.location.pathname;return a.startsWith("/admin/vouchers")?p(Pt,{}):a.startsWith("/admin/settings")?p(Vt,{}):a.startsWith("/admin/updater")?p(Ht,{}):a.startsWith("/admin/network")?p(Bt,{}):a.startsWith("/admin/portal-editor")?p(Ot,{}):a.startsWith("/admin/debug")?p(Jt,{}):p(kt,{})},r=()=>j(os,{children:[p("div",{className:"flex items-center justify-center h-16 bg-indigo-700",children:p("span",{className:"text-white font-bold text-xl",children:"SULIT WIFI"})}),j("nav",{className:"mt-5 flex-1 px-2 space-y-1",children:[p(Q,{href:"/admin/dashboard",icon:Xt,children:"Dashboard"}),p(Q,{href:"/admin/vouchers",icon:X,children:"Vouchers"}),p(Q,{href:"/admin/network",icon:ge,children:"Network"}),p(Q,{href:"/admin/portal-editor",icon:Kt,children:"Portal Editor"}),p(Q,{href:"/admin/settings",icon:pe,children:"Settings"}),p(Q,{href:"/admin/updater",icon:ue,children:"Updater & Backup"}),p(Q,{href:"/admin/debug",icon:Zt,children:"Debug Info"})]}),p("div",{className:"p-4",children:p("button",{onClick:e,className:"w-full text-left flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-300 hover:bg-indigo-500 hover:text-white",children:"Logout"})})]});return j("div",{className:"flex h-screen bg-gray-100",children:[p("div",{className:"hidden md:flex md:flex-shrink-0",children:p("div",{className:"flex flex-col w-64",children:p("div",{className:"flex flex-col h-0 flex-1 bg-indigo-800",children:p(r,{})})})}),j("div",{className:"flex flex-col w-0 flex-1 overflow-hidden",children:[p("div",{className:"md:hidden pl-1 pt-1 sm:pl-3 sm:pt-3",children:j("button",{onClick:()=>t(!0),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500",children:[p("span",{className:"sr-only",children:"Open sidebar"}),p("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:p("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]})}),o&&p("div",{className:"md:hidden",children:j("div",{className:"fixed inset-0 flex z-40",children:[p("div",{className:"fixed inset-0",children:p("div",{className:"absolute inset-0 bg-gray-600 opacity-75",onClick:()=>t(!1)})}),j("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-indigo-800",children:[p("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:j("button",{onClick:()=>t(!1),className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",children:[p("span",{className:"sr-only",children:"Close sidebar"}),p("svg",{className:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:p("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})}),p(r,{})]}),p("div",{className:"flex-shrink-0 w-14"})]})}),p("main",{className:"flex-1 relative z-0 overflow-y-auto focus:outline-none p-6",children:s()})]})]})},Qt=ts;import{jsx as fe}from"react/jsx-runtime";var as=()=>{let[e,o]=eo(!1),[t,s]=eo(!0);ss(()=>{localStorage.getItem("admin_token")&&o(!0),s(!1)},[]);let r=()=>{localStorage.removeItem("admin_token"),o(!1),window.location.href="/admin"},a=()=>{o(!0),window.location.href="/admin"};return t?fe("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):window.location.pathname.startsWith("/admin")?e?fe(Qt,{onLogout:r}):fe(gt,{onLoginSuccess:a}):fe(ct,{})},to=as;import{jsx as oo}from"react/jsx-runtime";var is=ns.createRoot(document.getElementById("root"));is.render(oo(rs.StrictMode,{children:oo(to,{})}));
